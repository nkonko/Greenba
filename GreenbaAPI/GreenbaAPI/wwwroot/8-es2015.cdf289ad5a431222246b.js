(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{jkDv:function(t,e,o){"use strict";o.r(e),o.d(e,"AdminModule",(function(){return st}));var r=o("SVse"),i=o("PCNd"),s=o("iInd"),c=o("8Y7J"),n=o("mwRl"),a=o("AytR"),b=o("IheW");let d=(()=>{class t{constructor(t){this.http=t,this.baseUrl=a.a.apiUrl}createProduct(t){return this.http.post(this.baseUrl+"products",t)}updateProduct(t,e){return this.http.put(this.baseUrl+"products/"+e,t)}deleteProduct(t){return this.http.delete(this.baseUrl+"products/"+t)}uploadImage(t,e){const o=new FormData;return o.append("photo",t,"image.png"),this.http.put(this.baseUrl+"products/"+e+"/photo",o,{reportProgress:!0,observe:"events"})}deleteProductPhoto(t,e){return this.http.delete(this.baseUrl+"products/"+e+"/photo"+t)}setMainPhoto(t,e){return this.http.post(this.baseUrl+"products/"+e+"/photo/"+t,{})}getAllUsers(){return this.http.get(this.baseUrl+"account/getallusers")}}return t.\u0275fac=function(e){return new(e||t)(c.Zb(b.b))},t.\u0275prov=c.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var l=o("/gyc"),u=o("a4eG");const p=function(t){return["edit",t]};function g(t,e){if(1&t){const t=c.Wb();c.Vb(0,"tr"),c.Vb(1,"td",18),c.Jc(2),c.Ub(),c.Vb(3,"td"),c.Vb(4,"div",12),c.Qb(5,"img",19),c.Ub(),c.Ub(),c.Vb(6,"th",18),c.Vb(7,"h5"),c.Jc(8),c.Ub(),c.Ub(),c.Vb(9,"td",18),c.Jc(10),c.hc(11,"currency"),c.Ub(),c.Vb(12,"td",18),c.Vb(13,"button",20),c.Jc(14,"Editar"),c.Ub(),c.Ub(),c.Vb(15,"td",18),c.Vb(16,"button",21),c.dc("click",(function(){c.Ac(t);const o=e.$implicit;return c.gc(2).deleteProduct(o.id)})),c.Jc(17,"Borrar"),c.Ub(),c.Ub(),c.Ub()}if(2&t){const t=e.$implicit;c.Bb(2),c.Kc(t.id),c.Bb(3),c.oc("src",t.pictureUrl||"/assets/images/placeholder.png",c.Cc),c.oc("alt",t.name),c.Bb(3),c.Kc(t.name),c.Bb(2),c.Kc(c.ic(11,6,t.price)),c.Bb(3),c.nc("routerLink",c.rc(8,p,t.id))}}function h(t,e){if(1&t){const t=c.Wb();c.Vb(0,"div",22),c.Vb(1,"app-pager",23),c.dc("pageChanged",(function(e){return c.Ac(t),c.gc(2).onPageChanged(e)})),c.Ub(),c.Ub()}if(2&t){const t=c.gc(2);c.Bb(1),c.nc("pageSize",t.shopParams.pageSize)("pageNumber",t.shopParams.pageNumber)("totalCount",t.totalCount)}}const m=function(){return["/admin/create"]};function v(t,e){if(1&t&&(c.Vb(0,"section",1),c.Vb(1,"div",2),c.Vb(2,"div",3),c.Vb(3,"div",4),c.Vb(4,"div",5),c.Vb(5,"header",6),c.Jc(6,"Lista de productos"),c.Ub(),c.Vb(7,"button",7),c.Jc(8,"Crear nuevo producto"),c.Ub(),c.Ub(),c.Qb(9,"app-paging-header",8),c.Vb(10,"div",9),c.Vb(11,"table",10),c.Vb(12,"thead"),c.Vb(13,"tr"),c.Vb(14,"th",11),c.Vb(15,"div",12),c.Jc(16,"#"),c.Ub(),c.Ub(),c.Vb(17,"th",11),c.Vb(18,"div",13),c.Jc(19,"Producto"),c.Ub(),c.Ub(),c.Vb(20,"th",11),c.Vb(21,"div",14),c.Jc(22,"Nombre"),c.Ub(),c.Ub(),c.Vb(23,"th",11),c.Vb(24,"div",15),c.Jc(25,"Precio"),c.Ub(),c.Ub(),c.Vb(26,"th",11),c.Vb(27,"div",15),c.Jc(28,"Editar"),c.Ub(),c.Ub(),c.Vb(29,"th",11),c.Vb(30,"div",15),c.Jc(31,"Borrar"),c.Ub(),c.Ub(),c.Ub(),c.Ub(),c.Vb(32,"tbody"),c.Hc(33,g,18,10,"tr",16),c.Ub(),c.Ub(),c.Ub(),c.Hc(34,h,2,3,"div",17),c.Ub(),c.Ub(),c.Ub(),c.Ub()),2&t){const t=c.gc();c.Bb(7),c.nc("routerLink",c.qc(6,m)),c.Bb(2),c.nc("totalCount",t.totalCount)("pageSize",t.shopParams.pageSize)("pageNumber",t.shopParams.pageNumber),c.Bb(24),c.nc("ngForOf",t.products),c.Bb(1),c.nc("ngIf",t.totalCount>0)}}let f=(()=>{class t{constructor(t,e){this.shopService=t,this.adminservice=e,this.shopParams=this.shopService.getShopParams()}ngOnInit(){this.getProducts()}getProducts(t=!1){this.shopService.getProducts(t).subscribe(t=>{this.products=t.data,this.totalCount=t.count},t=>console.log(t))}onPageChanged(t){const e=this.shopService.getShopParams();e.pageNumber!==t&&(e.pageNumber=t,this.shopService.setShopParams(e),this.getProducts(!0))}deleteProduct(t){this.adminservice.deleteProduct(t).subscribe(()=>{this.products.splice(this.products.findIndex(e=>e.id===t),1),this.totalCount--,this.shopParams.pageSize*(this.shopParams.pageNumber-1)===this.totalCount&&(this.shopParams.pageNumber--,this.shopService.setShopParams(this.shopParams),this.getProducts())},t=>console.log(t))}}return t.\u0275fac=function(e){return new(e||t)(c.Pb(n.a),c.Pb(d))},t.\u0275cmp=c.Jb({type:t,selectors:[["app-admin"]],decls:1,vars:1,consts:[["class","admin-page",4,"ngIf"],[1,"admin-page"],[1,"container"],[1,"row"],[1,"col-lg-12"],[1,"d-flex","justify-content-between","my-3"],[1,"h2"],[1,"btn","btn-outline-success",3,"routerLink"],[3,"totalCount","pageSize","pageNumber"],[1,"table-responsive"],[1,"table"],["scope","col"],[1,"p-2"],[1,"p-2","text-uppercase"],[1,"py-2","text-uppercase"],[1,"p-2","px-3","text-uppercase"],[4,"ngFor","ngForOf"],["class","d-flex justify-content-center",4,"ngIf"],[1,"align-middle"],[1,"img-fluid",2,"max-height","50px",3,"src","alt"],[1,"btn","btn-warning",3,"routerLink"],[1,"btn","btn-danger",3,"click"],[1,"d-flex","justify-content-center"],[3,"pageSize","pageNumber","totalCount","pageChanged"]],template:function(t,e){1&t&&c.Hc(0,v,35,7,"section",0),2&t&&c.nc("ngIf",e.products)},directives:[r.m,s.d,l.a,r.l,u.a],pipes:[r.d],styles:[""]}),t})();class U{constructor(){this.sort="Newest",this.pageNumber=1,this.pageSize=6,this.level="Error"}}class V{constructor(){this.data=[]}}var P=o("lJxs"),y=o("wd/R");let B=(()=>{class t{constructor(t){this.http=t,this.baseUrl=a.a.apiUrl,this.logParams=new U,this.pagination=new V}getLogsByParams(){let t=new b.f;return t=t.append("sort",this.logParams.sort),t=t.append("pageIndex",this.logParams.pageNumber.toString()),t=t.append("pageSize",this.logParams.pageSize.toString()),t=t.append("level",this.logParams.level),this.logParams&&(this.logParams.dateFrom&&(this.logParams.dateFrom=y(this.logParams.dateFrom).format("YYYY-MM-DD"),t=t.append("dateFrom",this.logParams.dateFrom)),this.logParams.dateTo&&(this.logParams.dateTo=y(this.logParams.dateTo).format("YYYY-MM-DD"),t=t.append("dateTo",this.logParams.dateTo))),this.http.get(this.baseUrl+"logs",{observe:"response",params:t}).pipe(Object(P.a)(t=>(this.pagination=t.body,this.pagination)))}getLogDetailed(t){return this.http.get(this.baseUrl+"logs/"+t)}getLogParams(){return this.logParams}setLogParams(t){this.logParams=t}}return t.\u0275fac=function(e){return new(e||t)(c.Zb(b.b))},t.\u0275prov=c.Lb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function J(t,e){if(1&t&&(c.Vb(0,"div",1),c.Vb(1,"div",2),c.Vb(2,"div",3),c.Vb(3,"h3"),c.Jc(4),c.Ub(),c.Ub(),c.Ub(),c.Vb(5,"div",2),c.Vb(6,"div",4),c.Vb(7,"h4"),c.Jc(8,"Mensaje"),c.Ub(),c.Vb(9,"p"),c.Jc(10),c.hc(11,"slice"),c.Ub(),c.Ub(),c.Ub(),c.Vb(12,"div",2),c.Vb(13,"div",5),c.Vb(14,"h4"),c.Jc(15,"Exepcion"),c.Ub(),c.Vb(16,"p"),c.Jc(17),c.Ub(),c.Ub(),c.Ub(),c.Ub()),2&t){const t=c.gc();c.Bb(4),c.Lc("Log n\xb0: ",t.log.id,""),c.Bb(6),c.Kc(c.kc(11,3,t.log.message,0,130)),c.Bb(7),c.Kc(t.log.exception)}}let S=(()=>{class t{constructor(t,e){this.logService=t,this.activatedRoute=e}ngOnInit(){this.loadLog()}loadLog(){this.logService.getLogDetailed(+this.activatedRoute.snapshot.paramMap.get("id")).subscribe(t=>{this.log=t},t=>console.log(t))}}return t.\u0275fac=function(e){return new(e||t)(c.Pb(B),c.Pb(s.a))},t.\u0275cmp=c.Jb({type:t,selectors:[["app-log-detail"]],decls:1,vars:1,consts:[["class","container mt-5",4,"ngIf"],[1,"container","mt-5"],[1,"row"],[1,"col-12"],[1,"col-6"],[1,"col-12","ml-3"]],template:function(t,e){1&t&&c.Hc(0,J,18,7,"div",0),2&t&&c.nc("ngIf",e.log)},directives:[r.m],pipes:[r.t],styles:[""]}),t})();var F=o("s7LF"),I=o("VfTn");function w(t,e){if(1&t&&(c.Vb(0,"option",17),c.Jc(1),c.Ub()),2&t){const t=e.$implicit,o=c.gc();c.nc("selected",o.logParams.sort===t.value)("value",t.value),c.Bb(1),c.Kc(t.name)}}function C(t,e){if(1&t&&(c.Vb(0,"option",17),c.Jc(1),c.Ub()),2&t){const t=e.$implicit,o=c.gc();c.nc("selected",o.logParams.sort===t.value)("value",t.value),c.Bb(1),c.Kc(t.name)}}function O(t,e){if(1&t&&(c.Vb(0,"tr",18),c.Vb(1,"th"),c.Jc(2),c.Ub(),c.Vb(3,"td"),c.Jc(4),c.hc(5,"slice"),c.Ub(),c.Vb(6,"td"),c.Jc(7),c.hc(8,"slice"),c.Ub(),c.Vb(9,"td"),c.Jc(10),c.hc(11,"slice"),c.Ub(),c.Vb(12,"td"),c.Jc(13),c.Ub(),c.Vb(14,"td"),c.Jc(15),c.Ub(),c.Ub()),2&t){const t=e.$implicit;c.oc("routerLink",t.id),c.Bb(2),c.Kc(t.id),c.Bb(2),c.Kc(c.kc(5,7,t.message,0,30)),c.Bb(3),c.Kc(c.kc(8,11,t.logged,0,10)),c.Bb(3),c.Kc(c.kc(11,15,t.exception,0,65)),c.Bb(3),c.Kc(t.level),c.Bb(2),c.Kc(t.logger)}}let k=(()=>{class t{constructor(t,e){this.logService=t,this.fb=e,this.timeOptions=[{name:"Mas nuevos",value:"Newest"},{name:"Mas viejos",value:"Oldest"}],this.levelOptions=[{name:"Alta",value:"Error"},{name:"Media",value:"Warn"},{name:"Baja",value:"Info"}],this.logParams=this.logService.getLogParams()}ngOnInit(){this.getLogs(),this.createForm()}getLogs(){this.logService.getLogsByParams().subscribe(t=>{this.logs=t.data,this.totalCount=t.count},t=>{console.log(t)})}onSortSelected(t){const e=this.logService.getLogParams();e.sort=t,this.logService.setLogParams(e),this.getLogs()}onPageChanged(t){const e=this.logService.getLogParams();e.pageNumber!==t&&(e.pageNumber=t,this.logService.getLogParams(),this.getLogs())}createForm(){this.logForm=this.fb.group({dateFrom:[null,F.r.required],dateTo:[null,F.r.required]})}onLevelSelected(t){const e=this.logService.getLogParams();e.level=t,this.logService.setLogParams(e),this.getLogs()}filter(){if(this.logForm.controls.dateFrom.value||this.logForm.controls.dateTo.value){const t=this.logService.getLogParams();t.dateFrom=this.logForm.controls.dateFrom.value,t.dateTo=this.logForm.controls.dateTo.value,this.logService.setLogParams(t),this.logService.getLogsByParams().subscribe(t=>{this.logs=t.data,this.totalCount=t.count},t=>{console.log(t)})}}}return t.\u0275fac=function(e){return new(e||t)(c.Pb(B),c.Pb(F.b))},t.\u0275cmp=c.Jb({type:t,selectors:[["app-logs"]],decls:44,vars:7,consts:[[1,"container","mt-3"],[1,"row","align-items-start"],[1,"col-3"],[1,"text-warning"],[1,"custom-select","mb-3","mb-4",3,"change"],[3,"selected","value",4,"ngFor","ngForOf"],[1,"col-3","mb-3"],[3,"formGroup"],["formControlName","dateFrom","placeholder","Desde",3,"ngModelChange"],["formControlName","dateTo","placeholder","Hasta",3,"ngModelChange"],[1,"row"],[1,"col-12"],[1,"table","table-hover",2,"cursor","pointer"],[1,"thead-light"],[3,"routerLink",4,"ngFor","ngForOf"],[1,"d-flex","justify-content-center"],[3,"pageSize","totalCount","pageNumber","pageChanged"],[3,"selected","value"],[3,"routerLink"]],template:function(t,e){1&t&&(c.Vb(0,"div",0),c.Vb(1,"div",1),c.Vb(2,"div",2),c.Vb(3,"div"),c.Vb(4,"h4",3),c.Jc(5,"Antig\xfcedad"),c.Ub(),c.Vb(6,"select",4),c.dc("change",(function(t){return e.onSortSelected(t.target.value)})),c.Hc(7,w,2,3,"option",5),c.Ub(),c.Ub(),c.Ub(),c.Vb(8,"div",6),c.Vb(9,"form",7),c.Vb(10,"h4",3),c.Jc(11,"Fecha desde:"),c.Ub(),c.Vb(12,"app-datepicker",8),c.dc("ngModelChange",(function(){return e.filter()})),c.Ub(),c.Qb(13,"br"),c.Vb(14,"h4",3),c.Jc(15,"Fecha hasta:"),c.Ub(),c.Vb(16,"app-datepicker",9),c.dc("ngModelChange",(function(){return e.filter()})),c.Ub(),c.Ub(),c.Ub(),c.Vb(17,"div",6),c.Vb(18,"div"),c.Vb(19,"h4",3),c.Jc(20,"Nivel"),c.Ub(),c.Vb(21,"select",4),c.dc("change",(function(t){return e.onLevelSelected(t.target.value)})),c.Hc(22,C,2,3,"option",5),c.Ub(),c.Ub(),c.Ub(),c.Ub(),c.Vb(23,"div",10),c.Vb(24,"div",11),c.Vb(25,"table",12),c.Vb(26,"thead",13),c.Vb(27,"tr"),c.Vb(28,"th"),c.Jc(29,"#"),c.Ub(),c.Vb(30,"th"),c.Jc(31,"Mensaje"),c.Ub(),c.Vb(32,"th"),c.Jc(33,"Fecha"),c.Ub(),c.Vb(34,"th"),c.Jc(35,"Excepcion"),c.Ub(),c.Vb(36,"th"),c.Jc(37,"Nivel"),c.Ub(),c.Vb(38,"th"),c.Jc(39,"Componente"),c.Ub(),c.Ub(),c.Ub(),c.Vb(40,"tbody"),c.Hc(41,O,16,19,"tr",14),c.Ub(),c.Ub(),c.Vb(42,"div",15),c.Vb(43,"app-pager",16),c.dc("pageChanged",(function(t){return e.onPageChanged(t)})),c.Ub(),c.Ub(),c.Ub(),c.Ub(),c.Ub()),2&t&&(c.Bb(7),c.nc("ngForOf",e.timeOptions),c.Bb(2),c.nc("formGroup",e.logForm),c.Bb(13),c.nc("ngForOf",e.levelOptions),c.Bb(19),c.nc("ngForOf",e.logs),c.Bb(2),c.nc("pageSize",e.logParams.pageSize)("totalCount",e.totalCount)("pageNumber",e.logParams.pageNumber))},directives:[r.l,F.t,F.m,F.f,I.a,F.l,F.d,u.a,F.o,F.s,s.d],pipes:[r.t],styles:[""]}),t})();class L{constructor(t){this.name="",this.description="",this.price=0,this.pictureUrl="",Object.assign(this,t)}}var x=o("cp0P"),M=o("2ZVE"),N=o("gA0Q");const T=["input"];function D(t,e){if(1&t&&(c.Vb(0,"option",6),c.Jc(1),c.Ub()),2&t){const t=e.$implicit,o=c.gc();c.nc("value",t.id)("selected",t.id===o.selectedId),c.Bb(1),c.Lc(" ",t.name," ")}}function E(t,e){if(1&t&&(c.Vb(0,"span"),c.Jc(1),c.Ub()),2&t){const t=c.gc(2);c.Bb(1),c.Lc("",t.label," Es necesario")}}function A(t,e){if(1&t&&(c.Vb(0,"div",7),c.Hc(1,E,2,1,"span",8),c.Ub()),2&t){const t=c.gc();c.oc("id",t.label),c.Bb(1),c.nc("ngIf",null==t.controlDir.control.errors?null:t.controlDir.control.errors.required)}}let j=(()=>{class t{constructor(t){this.controlDir=t,this.controlDir.valueAccessor=this}ngOnInit(){const t=this.controlDir.control,e=t.asyncValidator?[t.asyncValidator]:[];t.setValidators(t.validator?[t.validator]:[]),t.setAsyncValidators(e),t.updateValueAndValidity()}onChange(t){}onTouched(){}writeValue(t){this.input.nativeElement.value=t}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}}return t.\u0275fac=function(e){return new(e||t)(c.Pb(F.k,2))},t.\u0275cmp=c.Jb({type:t,selectors:[["app-select-dropdown"]],viewQuery:function(t,e){var o;1&t&&c.Ec(T,!0),2&t&&c.wc(o=c.ec())&&(e.input=o.first)},inputs:{label:"label",Items:"Items",selectedId:"selectedId"},decls:6,vars:4,consts:[[1,"form-label-group"],[1,"form-control",3,"id","ngClass","change","blur"],["input",""],["value","null","label","-- Seleccionar --","disabled","","selected","selected"],[3,"value","selected",4,"ngFor","ngForOf"],["class","invalid-feedback d-block",3,"id",4,"ngIf"],[3,"value","selected"],[1,"invalid-feedback","d-block",3,"id"],[4,"ngIf"]],template:function(t,e){1&t&&(c.Vb(0,"div",0),c.Vb(1,"select",1,2),c.dc("change",(function(t){return e.onChange(t.target.value-0)}))("blur",(function(){return e.onTouched()})),c.Qb(3,"option",3),c.Hc(4,D,2,3,"option",4),c.Ub(),c.Hc(5,A,2,2,"div",5),c.Ub()),2&t&&(c.Bb(1),c.oc("id",e.label),c.nc("ngClass",e.controlDir&&e.controlDir.control&&e.controlDir.control.touched?e.controlDir.control.valid?"is-valid":"is-invalid":null),c.Bb(3),c.nc("ngForOf",e.Items),c.Bb(1),c.nc("ngIf",e.controlDir&&e.controlDir.control&&!e.controlDir.control.valid&&e.controlDir.control.touched))},directives:[r.k,F.o,F.s,r.l,r.m],styles:[""]}),t})(),z=(()=>{class t{constructor(t,e,o){this.route=t,this.adminService=e,this.router=o}ngOnInit(){this.createEditProductForm(),this.editProductForm.patchValue(this.product)}createEditProductForm(){this.editProductForm=new F.e({name:new F.c("",F.r.required),price:new F.c(0,[F.r.required,F.r.min(.01),this.regexValidator(new RegExp("\\$?([0-9]{1,3},([0-9]{3},)*[0-9]{3}|[0-9]+)(\\.[0-9][0-9])?$"),{noDecimal:!0})]),description:new F.c(null,F.r.required),productBrandId:new F.c(null,F.r.required),productTypeId:new F.c(null,F.r.required)})}onSubmit(){if("edit"===this.route.snapshot.url[0].path){const t=Object.assign(Object.assign(Object.assign({},this.product),this.editProductForm.value),{price:+this.editProductForm.get("price").value});this.adminService.updateProduct(t,+this.route.snapshot.paramMap.get("id")).subscribe(()=>{this.router.navigate(["/admin"])},t=>console.log(t))}else{const t=Object.assign(Object.assign({},this.editProductForm.value),{price:+this.editProductForm.get("price").value});this.adminService.createProduct(t).subscribe(()=>{this.router.navigate(["/admin"])},t=>console.log(t))}}regexValidator(t,e){return o=>o.value?t.test(o.value)?null:e:null}}return t.\u0275fac=function(e){return new(e||t)(c.Pb(s.a),c.Pb(d),c.Pb(s.c))},t.\u0275cmp=c.Jb({type:t,selectors:[["app-edit-product-form"]],inputs:{product:"product",brands:"brands",types:"types"},decls:20,vars:13,consts:[[3,"formGroup","ngSubmit"],[1,"form-row"],[1,"form-group","col-md-6"],["formControlName","name",3,"label"],["formControlName","price",3,"label","type"],[1,"form-group","col-md-12"],["formControlName","description",3,"label","type"],["formControlName","productTypeId",3,"label","Items","selectedId"],["formControlName","productBrandId",3,"label","Items","selectedId"],["type","submit",1,"btn","btn-primary","my-3","float-right",3,"disabled"]],template:function(t,e){1&t&&(c.Vb(0,"form",0),c.dc("ngSubmit",(function(){return e.onSubmit()})),c.Vb(1,"div",1),c.Vb(2,"div",2),c.Qb(3,"app-text-input",3),c.Ub(),c.Vb(4,"div",2),c.Qb(5,"app-text-input",4),c.Ub(),c.Ub(),c.Vb(6,"div",1),c.Vb(7,"div",5),c.Qb(8,"app-text-input",6),c.Ub(),c.Ub(),c.Vb(9,"div",1),c.Vb(10,"div",2),c.Vb(11,"label"),c.Jc(12,"Categorias"),c.Ub(),c.Qb(13,"app-select-dropdown",7),c.Ub(),c.Vb(14,"div",2),c.Vb(15,"label"),c.Jc(16,"Marcas"),c.Ub(),c.Qb(17,"app-select-dropdown",8),c.Ub(),c.Ub(),c.Vb(18,"button",9),c.Jc(19,"Enviar"),c.Ub(),c.Ub()),2&t&&(c.nc("formGroup",e.editProductForm),c.Bb(3),c.nc("label","Nombre"),c.Bb(2),c.nc("label","Precio")("type","number"),c.Bb(3),c.nc("label","Descripcion")("type","textarea"),c.Bb(5),c.nc("label","Categorias")("Items",e.types)("selectedId",e.product.productTypeId),c.Bb(4),c.nc("label","Marcas")("Items",e.brands)("selectedId",e.product.productBrandId),c.Bb(1),c.nc("disabled",e.editProductForm.invalid))},directives:[F.t,F.m,F.f,N.a,F.l,F.d,j],styles:[""]}),t})();var H=o("EApP"),Q=o("YD+O"),K=o("tq8E");function $(t,e){if(1&t){const t=c.Wb();c.Tb(0),c.Qb(1,"img",7),c.Vb(2,"button",8),c.dc("click",(function(){return c.Ac(t),c.gc().onUpload()})),c.Jc(3,"Subir imagen"),c.Ub(),c.Sb()}if(2&t){const t=c.gc();c.Bb(1),c.nc("src",t.croppedImage,c.Cc)}}let R=(()=>{class t{constructor(){this.addFile=new c.n,this.files=[],this.imageChangedEvent="",this.croppedImage=""}ngOnInit(){}onSelect(t){this.files=[],this.files.push(...t.addedFiles),this.fileChangeEvent(this.files[0])}fileChangeEvent(t){this.imageChangedEvent=t}imageCropped(t){this.croppedImage=t.base64}onUpload(){console.log(Object(Q.c)(this.croppedImage)),this.addFile.emit(Object(Q.c)(this.croppedImage))}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=c.Jb({type:t,selectors:[["app-photo-widget"]],outputs:{addFile:"addFile"},decls:17,vars:5,consts:[[1,"row"],[1,"col-4"],["ngx-dropzone","",1,"custom-dropzone",3,"change"],[1,"fa","fa-upload","fa-4x"],[1,"col-4","img-preview"],["format","png",1,"img-fluid",3,"imageChangedEvent","imageFile","maintainAspectRatio","aspectRatio","imageCropped"],[4,"ngIf"],[1,"img-fluid",3,"src"],[1,"btn-block","btn-primary",3,"click"]],template:function(t,e){1&t&&(c.Vb(0,"div",0),c.Vb(1,"div",1),c.Vb(2,"h3"),c.Jc(3,"Paso 1 - Agregar foto"),c.Ub(),c.Vb(4,"div",2),c.dc("change",(function(t){return e.onSelect(t)})),c.Vb(5,"ngx-dropzone-label"),c.Qb(6,"i",3),c.Vb(7,"h4"),c.Jc(8,"Soltar la imagen aqui"),c.Ub(),c.Ub(),c.Ub(),c.Ub(),c.Vb(9,"div",4),c.Vb(10,"h3"),c.Jc(11,"Paso 2 - Redimension"),c.Ub(),c.Vb(12,"image-cropper",5),c.dc("imageCropped",(function(t){return e.imageCropped(t)})),c.Ub(),c.Ub(),c.Vb(13,"div",1),c.Vb(14,"h3"),c.Jc(15,"Paso 3 - Revision"),c.Ub(),c.Hc(16,$,4,1,"ng-container",6),c.Ub(),c.Ub()),2&t&&(c.Bb(12),c.nc("imageChangedEvent",e.imageChangedEvent)("imageFile",e.files[0])("maintainAspectRatio",!0)("aspectRatio",1),c.Bb(4),c.nc("ngIf",e.croppedImage))},directives:[K.a,K.c,Q.a,r.m],styles:[".custom-dropzone[_ngcontent-%COMP%]{border:3px dashed #eee;border-radius:5px;padding-top:30px;text-align:center;height:200px}.custom-dropzone.ngx-dz-hovered[_ngcontent-%COMP%]{border:3px solid green}"]}),t})();function q(t,e){if(1&t){const t=c.Wb();c.Vb(0,"div",7),c.Vb(1,"div",8),c.Qb(2,"img",9),c.Vb(3,"div",10),c.Vb(4,"button",11),c.dc("click",(function(){c.Ac(t);const o=e.$implicit;return c.gc(2).setMainPhoto(o.id)})),c.Jc(5," Principal "),c.Ub(),c.Vb(6,"button",12),c.dc("click",(function(){c.Ac(t);const o=e.$implicit;return c.gc(2).deletePhoto(o.id)})),c.Qb(7,"i",13),c.Ub(),c.Ub(),c.Ub(),c.Ub()}if(2&t){const t=e.$implicit;c.Bb(2),c.oc("src",t.pictureUrl,c.Cc),c.oc("alt",t.fileName),c.Bb(2),c.Db(t.isMain?"btn btn-success":"btn btn-outline-success"),c.nc("disabled",t.isMain),c.Bb(2),c.nc("disabled",t.isMain)}}function W(t,e){if(1&t){const t=c.Wb();c.Tb(0),c.Vb(1,"div",3),c.Vb(2,"h3"),c.Jc(3,"Fotos de producto"),c.Ub(),c.Vb(4,"button",4),c.dc("click",(function(){return c.Ac(t),c.gc().addPhotoModeToggle()})),c.Jc(5," Agregar nueva foto "),c.Ub(),c.Ub(),c.Vb(6,"div",5),c.Hc(7,q,8,7,"div",6),c.Ub(),c.Sb()}if(2&t){const t=c.gc();c.Bb(7),c.nc("ngForOf",null==t.product?null:t.product.photos)}}function Y(t,e){if(1&t&&(c.Vb(0,"div",17),c.Vb(1,"div",18),c.Jc(2),c.Ub(),c.Ub()),2&t){const t=c.gc(2);c.Bb(1),c.Gc("width",t.progress,"%"),c.Bb(1),c.Lc(" ",t.progress,"% ")}}function G(t,e){if(1&t){const t=c.Wb();c.Tb(0),c.Vb(1,"div",3),c.Vb(2,"h3"),c.Jc(3,"Agregar nueva imagen"),c.Ub(),c.Vb(4,"button",14),c.dc("click",(function(){return c.Ac(t),c.gc().addPhotoModeToggle()})),c.Jc(5," Cancelar "),c.Ub(),c.Ub(),c.Hc(6,Y,3,3,"div",15),c.Vb(7,"app-photo-widget",16),c.dc("addFile",(function(e){return c.Ac(t),c.gc().uploadFile(e)})),c.Ub(),c.Sb()}if(2&t){const t=c.gc();c.Bb(6),c.nc("ngIf",t.progress>0)}}let Z=(()=>{class t{constructor(t,e){this.adminService=t,this.toast=e,this.progress=0,this.addPhotoMode=!1}ngOnInit(){}addPhotoModeToggle(){this.addPhotoMode=!this.addPhotoMode}uploadFile(t){this.adminService.uploadImage(t,this.product.id).subscribe(t=>{switch(t.type){case b.d.UploadProgress:this.progress=Math.round(t.loaded/t.total*100);break;case b.d.Response:this.product=t.body,setTimeout(()=>{this.progress=0,this.addPhotoMode=!1},1500)}},t=>{this.toast.error(t.errors?t.errors[0]:"Problema al cargar imagen"),this.progress=0})}deletePhoto(t){this.adminService.deleteProductPhoto(t,this.product.id).subscribe(()=>{const e=this.product.photos.findIndex(e=>e.id===t);this.product.photos.splice(e,1)},t=>{this.toast.error("Problema al borrar imagen"),console.log(t)})}setMainPhoto(t){this.adminService.setMainPhoto(t,this.product.id).subscribe(t=>{this.product=t})}}return t.\u0275fac=function(e){return new(e||t)(c.Pb(d),c.Pb(H.b))},t.\u0275cmp=c.Jb({type:t,selectors:[["app-edit-product-photos"]],inputs:{product:"product"},decls:4,vars:2,consts:[[1,"py-5"],[1,"container"],[4,"ngIf"],[1,"d-flex","justify-content-between","mb-3"],[1,"btn","btn-primary",3,"click"],[1,"row"],["class","col-3",4,"ngFor","ngForOf"],[1,"col-3"],[1,"card"],["width","100%","height","225",1,"card-img-top",3,"src","alt"],[1,"btn-group",2,"width","100%"],["type","button",2,"width","50%",3,"disabled","click"],["type","button",1,"btn","btn-outline-danger",2,"width","50%",3,"disabled","click"],[1,"fa","fa-trash"],[1,"btn","btn-outline-secondary",3,"click"],["class","progress form-group",4,"ngIf"],[3,"addFile"],[1,"progress","form-group"],["role","progressbar",1,"progress-bar","progress-bar-striped","bg-success"]],template:function(t,e){1&t&&(c.Vb(0,"div",0),c.Vb(1,"div",1),c.Hc(2,W,8,1,"ng-container",2),c.Hc(3,G,8,1,"ng-container",2),c.Ub(),c.Ub()),2&t&&(c.Bb(2),c.nc("ngIf",!e.addPhotoMode),c.Bb(1),c.nc("ngIf",e.addPhotoMode))},directives:[r.m,r.l,R],styles:[""]}),t})(),_=(()=>{class t{constructor(t,e){this.shopService=t,this.route=e,this.productFormValues=new L}ngOnInit(){const t=this.getBrands(),e=this.getTypes();Object(x.a)([e,t]).subscribe(t=>{this.brands=t[0],this.types=t[1]},t=>console.log(t),()=>{"edit"===this.route.snapshot.url[0].path&&this.loadProduct()})}loadProduct(){const t=+this.route.snapshot.paramMap.get("id");this.shopService.getProduct(t).subscribe(t=>{const e=this.brands&&this.brands.find(e=>e.name===t.productBrand).id,o=this.types&&this.types.find(e=>e.name===t.productType).id;this.product=t,this.productFormValues=Object.assign(Object.assign({},t),{productBrandId:e,productTypeId:o})})}getTypes(){return this.shopService.getBrands()}getBrands(){return this.shopService.getTypes()}}return t.\u0275fac=function(e){return new(e||t)(c.Pb(n.a),c.Pb(s.a))},t.\u0275cmp=c.Jb({type:t,selectors:[["app-edit-product"]],decls:11,vars:4,consts:[[1,"product-edit","mt-5"],[1,"container"],[1,"row"],[1,"col-12"],[1,"tab-panel"],[1,"product-tabset"],["heading","Editar Producto"],[1,"col-lg-8"],[3,"product","brands","types"],["heading","Editar Fotos"],[3,"product"]],template:function(t,e){1&t&&(c.Vb(0,"section",0),c.Vb(1,"div",1),c.Vb(2,"div",2),c.Vb(3,"div",3),c.Vb(4,"div",4),c.Vb(5,"tabset",5),c.Vb(6,"tab",6),c.Vb(7,"div",7),c.Qb(8,"app-edit-product-form",8),c.Ub(),c.Ub(),c.Vb(9,"tab",9),c.Qb(10,"app-edit-product-photos",10),c.Ub(),c.Ub(),c.Ub(),c.Ub(),c.Ub(),c.Ub(),c.Ub()),2&t&&(c.Bb(8),c.nc("product",e.productFormValues)("brands",e.brands)("types",e.types),c.Bb(2),c.nc("product",e.product))},directives:[M.c,M.a,z,Z],styles:[""]}),t})();var X=o("2rwd");function tt(t,e){if(1&t){const t=c.Wb();c.Vb(0,"div"),c.Vb(1,"a",10),c.Vb(2,"i",11),c.dc("click",(function(){c.Ac(t);const e=c.gc().$implicit;return c.gc().disableUser(e)})),c.Ub(),c.Ub(),c.Ub()}}function et(t,e){if(1&t){const t=c.Wb();c.Vb(0,"div"),c.Vb(1,"a",12),c.Vb(2,"i",11),c.dc("click",(function(){c.Ac(t);const e=c.gc().$implicit;return c.gc().enableUser(e)})),c.Ub(),c.Ub(),c.Ub()}}function ot(t,e){if(1&t&&(c.Vb(0,"tr",7),c.Vb(1,"td",8),c.Vb(2,"strong"),c.Jc(3),c.Ub(),c.Ub(),c.Vb(4,"td",8),c.Vb(5,"strong"),c.Jc(6),c.Ub(),c.Ub(),c.Vb(7,"td",8),c.Vb(8,"strong"),c.Jc(9),c.Ub(),c.Ub(),c.Vb(10,"td",8),c.Hc(11,tt,3,0,"div",9),c.Hc(12,et,3,0,"div",9),c.Ub(),c.Ub()),2&t){const t=e.$implicit,o=e.index;c.Bb(3),c.Kc(o),c.Bb(3),c.Kc(t.displayName),c.Bb(3),c.Kc(t.email),c.Bb(2),c.nc("ngIf",t.active),c.Bb(1),c.nc("ngIf",!t.active)}}const rt=[{path:"",component:f},{path:"create",component:_,data:{breadcrumb:"Crear"}},{path:"edit/:id",component:_,data:{breadcrumb:"Editar"}},{path:"logs",component:k,data:{breadcrumb:"Bitacora"}},{path:"users",component:(()=>{class t{constructor(t,e,o,r){this.fb=t,this.admin=e,this.account=o,this.toast=r}ngOnInit(){this.currentUser=this.account.getCurrentUser(),this.loadUsers()}loadUsers(){this.admin.getAllUsers().subscribe(t=>{this.users=t.filter(t=>t.email!=this.currentUser.email)},t=>{console.log(t)})}disableUser(t){this.account.disableUser({userName:t.email}).subscribe(t=>{t&&(this.toast.success("Usuario deshabilitado"),this.loadUsers(),setTimeout(()=>{},3e3))},t=>{console.log(t)})}enableUser(t){this.account.enableUser({userName:t.email}).subscribe(t=>{t&&(this.toast.success("Usuario habilitado"),this.loadUsers(),setTimeout(()=>{},3e3))},t=>{console.log(t)})}}return t.\u0275fac=function(e){return new(e||t)(c.Pb(F.b),c.Pb(d),c.Pb(X.a),c.Pb(H.b))},t.\u0275cmp=c.Jb({type:t,selectors:[["app-users"]],decls:17,vars:1,consts:[[1,"table-responsive"],[1,"container","mt-5"],[1,"row"],[1,"col-12"],[1,"table","table-hover",2,"cursor","pointer"],[1,"thead-light"],["class","border-0",4,"ngFor","ngForOf"],[1,"border-0"],[1,"align-middle"],[4,"ngIf"],[1,"text-danger","ml-5"],[1,"fa","fa-user",2,"font-size","2em","cursor","pointer",3,"click"],[1,"text-success","ml-5"]],template:function(t,e){1&t&&(c.Vb(0,"div",0),c.Vb(1,"div",1),c.Vb(2,"div",2),c.Vb(3,"div",3),c.Vb(4,"table",4),c.Vb(5,"thead",5),c.Vb(6,"tr"),c.Vb(7,"th"),c.Jc(8,"#"),c.Ub(),c.Vb(9,"th"),c.Jc(10,"Nombre"),c.Ub(),c.Vb(11,"th"),c.Jc(12,"Email"),c.Ub(),c.Vb(13,"th"),c.Jc(14,"Habilitar/Deshabilitar"),c.Ub(),c.Ub(),c.Ub(),c.Vb(15,"tbody"),c.Hc(16,ot,13,5,"tr",6),c.Ub(),c.Ub(),c.Ub(),c.Ub(),c.Ub(),c.Ub()),2&t&&(c.Bb(16),c.nc("ngForOf",e.users))},directives:[r.l,r.m],styles:[""]}),t})(),data:{breadcrumb:"Usuarios"}},{path:"logs/:id",component:S,data:{breadcrumb:"Detalle"}}];let it=(()=>{class t{}return t.\u0275mod=c.Nb({type:t}),t.\u0275inj=c.Mb({factory:function(e){return new(e||t)},imports:[[s.g.forChild(rt)],s.g]}),t})(),st=(()=>{class t{}return t.\u0275mod=c.Nb({type:t}),t.\u0275inj=c.Mb({factory:function(e){return new(e||t)},imports:[[r.c,i.a,it]]}),t})()}}]);